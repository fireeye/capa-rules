rule:
  meta:
    name: capture webcam image
    namespace: collection/webcam
    author: johnk3r
    scope: function
    att&ck:
      - Collection::Video Capture [T1125]
    examples:
      - a30101595f6f28ab2f4b0b2cd177c3c4d2ab34a355ab7761a3795d0887c24ada:0x4011C0
  features:
    - and:
      - api: capCreateCaptureWindow
      - api: SendMessageA
      - optional:
        - api: capGetDriverDescription
        - api: capDriverConnect
        - api: capCaptureSequence
        - api: WM_CAP_DRIVER_CONNECT
        - api: WM_CAP_FILE_SAVEDIB
        - string: "AVICAP32.dll"
