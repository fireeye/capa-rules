rule:
  meta:
    name: hash data using FNV
    namespace: data-manipulation/hashing/fnv
    author: moritz.raabe@fireeye.com
    description: can be any Fowler-Noll-Vo (FNV) hash variant, including FNV-1, FNV-1a, FNV-0
    scope: function
    examples:
      - fd3ff5d9a5d9af87c467d9114294fc50:0x10011A80
    references:
      - http://isthe.com/chongo/tech/comp/fnv/
      - https://create.stephan-brumme.com/fnv-hash/
      - https://blog.morphisec.com/crystalbit-apple-double-dll-hijack
  features:
    - and:
      - or:
        - number: 16777619 = 32 bit FNV_prime
        - number: 1099511628211 = 64 bit FNV_prime
        # FNV-0 hash does not use these initialization values
      - optional:
        - number: 2166136261 = 32 bit offset_basis
        - number: 14695981039346656037 = 64 bit offset_basis
      # FNV-1 hash does multiply then XOR
      # FNV-1a hash does XOR then multiply
      - basic block:
        - and:
          - characteristic: nzxor
          - or:
            - mnemonic: imul
            - mnemonic: mul
