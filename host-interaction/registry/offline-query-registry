rule:
  meta:
    name: offline query registry
    namespace: host-interaction/registry
    author: johnk3r
    scope: function
    att&ck:
      - Discovery::Query Registry [T1012]
    mbc:
      - Operating System::Registry::Query Registry Key [C0036.005]
      - Operating System::Registry::Query Registry Value [C0036.006]
    examples:
      - 5fbbfeed28b258c42e0cfeb16718b31c:0x42388C
  features:
    - or:
         - api: ORQueryInfoKey
         - api: OREnumKey
         - api: OREnumValue
         - api: ORGetKeySecurity
         - api: ORGetVirtualFlags
         - api: ORGetValue
         - api: ORGetVersion