rule:
  meta:
    name: offline registry manipulation
    namespace: host-interaction/registry
    authOR: johnk3r
    scope: file
    att&ck:
      - Discovery::Query Registry [T1012]
    mbc:
      - Operating System::Registry::Query Registry Value [C0036.006]
      - Operating System::Registry::Create Registry Key [C0036.004]
      - Operating System::Registry::Open Registry Key [C0036.003]
    examples:
      - 3edc06a4784d1038c999b984d558b60d:0xEE20
  features:
    - and:
      - or:
        - string: offreg.dll
        - string: OFFREG.dll
      - or:
        - export: ORCloseHive
        - export: ORCloseHive
        - export: ORCloseKey
        - export: ORCreateHive
        - export: ORCreateKey
        - export: ORDeleteKey
        - export: ORDeleteValue
        - export: OREnumKey
        - export: OREnumValue
        - export: ORGetKeySecurity
        - export: ORGetValue
        - export: ORGetVersion
        - export: ORGetVirtualFlags
        - export: ORMergeHives
        - export: OROpenHive
        - export: OROpenHiveByHandle
        - export: OROpenKey
        - export: ORQueryInfoKey
        - export: ORRenameKey
        - export: ORSaveHive
        - export: ORSetKeySecurity
        - export: ORSetValue
        - export: ORSetVirtualFlags
