rule:
  meta:
    name: offline registry manipulation
    namespace: host-interaction/registry
    authOR: johnk3r
    scope: function
    att&ck:
      - Discovery::Query Registry [T1012]
    mbc:
      - Operating System::Registry::Query Registry Value [C0036.006]
      - Operating System::Registry::Create Registry Key [C0036.004]
      - Operating System::Registry::Open Registry Key [C0036.003]
    examples:
      - ee8daedce51559f8e7f27a667f114d32:0x100481A0
  features:
    - or:
        - api: ORCloseHive
        - api: ORCloseHive
        - api: ORCloseKey
        - api: ORCreateHive
        - api: ORCreateKey
        - api: ORDeleteKey
        - api: ORDeleteValue
        - api: OREnumKey
        - api: OREnumValue
        - api: ORGetKeySecurity
        - api: ORGetValue
        - api: ORGetVersion
        - api: ORGetVirtualFlags
        - api: ORMergeHives
        - api: OROpenHive
        - api: OROpenHiveByHandle
        - api: OROpenKey
        - api: ORQueryInfoKey
        - api: ORRenameKey
        - api: ORSaveHive
        - api: ORSetKeySecurity
        - api: ORSetValue
        - api: ORSetVirtualFlags
